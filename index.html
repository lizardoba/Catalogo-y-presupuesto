<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cat√°logo Dental</title>

<!-- ================= ESTILOS ================= -->
<style>
/* (ESTILOS SIN CAMBIOS IMPORTANTES ‚Äì ya estaban bien) */
/* Solo se eliminaron variables no usadas y errores menores */

body {
  font-family: Inter, system-ui, sans-serif;
  margin: 0;
  background: #f9fafb;
  color: #1f2937;
}

.header {
  background: linear-gradient(135deg, #21808d, #1a6873);
  color: white;
  padding: 32px;
  text-align: center;
}

.currency-selector {
  position: absolute;
  top: 20px;
  right: 20px;
}

.container {
  max-width: 1200px;
  margin: auto;
  padding: 32px;
}

.tabs {
  display: flex;
  gap: 16px;
  border-bottom: 2px solid #ddd;
  margin-bottom: 24px;
}

.tab-btn {
  background: none;
  border: none;
  padding: 12px 16px;
  cursor: pointer;
  font-weight: 600;
}

.tab-btn.active {
  color: #21808d;
  border-bottom: 3px solid #21808d;
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
}

.services-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px,1fr));
  gap: 20px;
}

.service-card {
  background: white;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 5px 15px rgba(0,0,0,.08);
  cursor: pointer;
  transition: transform .2s;
}

.service-card:hover {
  transform: translateY(-5px);
}

.btn {
  padding: 10px 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-weight: 600;
}

.btn-primary {
  background: #21808d;
  color: white;
}

.btn-secondary {
  background: #e5e7eb;
}

.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.6);
  align-items: center;
  justify-content: center;
}

.modal.active {
  display: flex;
}

.modal__content {
  background: white;
  padding: 24px;
  max-width: 800px;
  width: 90%;
  border-radius: 12px;
}

.modal__close {
  float: right;
  font-size: 22px;
  cursor: pointer;
}
</style>
</head>

<body>

<!-- ================= HEADER ================= -->
<div class="header">
  <select id="currencySelector" class="currency-selector">
    <option value="PEN">S/ Soles</option>
    <option value="USD">US$ D√≥lares</option>
  </select>
  <h1>ü¶∑ Cat√°logo Dental</h1>
  <p>Gesti√≥n de tratamientos y presupuestos</p>
</div>

<div class="container">

<!-- ================= TABS ================= -->
<div class="tabs">
  <button class="tab-btn active" data-tab="view">Ver</button>
  <button class="tab-btn" data-tab="budgets">Presupuestos</button>
</div>

<!-- ================= VER ================= -->
<div id="view" class="tab-content active">
  <div id="servicesGrid" class="services-grid"></div>
</div>

<!-- ================= PRESUPUESTOS ================= -->
<div id="budgets" class="tab-content">
  <h2>Presupuesto</h2>
  <ul id="budgetItems"></ul>
  <strong>Total: <span id="budgetTotal">S/ 0</span></strong>
</div>

</div>

<!-- ================= MODAL ================= -->
<div id="detailModal" class="modal">
  <div class="modal__content">
    <span class="modal__close" onclick="closeDetailModal()">‚úñ</span>
    <h2 id="detailTitle"></h2>
    <p id="detailDesc"></p>
  </div>
</div>

<!-- ================= SCRIPT ================= -->
<script>
/* ===== MONEDA ===== */
const rates = { PEN: 1, USD: 0.27 };
const symbols = { PEN: "S/", USD: "US$" };
let currency = localStorage.getItem("currency") || "PEN";

/* ===== DATOS ===== */
const treatments = [
  {
    id: 1,
    name: "Ortodoncia",
    desc: "Alineaci√≥n dental con brackets",
    price: 2500
  },
  {
    id: 2,
    name: "Endodoncia",
    desc: "Tratamiento de conducto",
    price: 700
  }
];

let budget = [];

/* ===== INIT ===== */
document.getElementById("currencySelector").value = currency;
renderServices();
updateBudget();

/* ===== TABS ===== */
document.querySelectorAll(".tab-btn").forEach(btn => {
  btn.onclick = () => {
    document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
    document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
    btn.classList.add("active");
    document.getElementById(btn.dataset.tab).classList.add("active");
  };
});

/* ===== RENDER ===== */
function renderServices() {
  const grid = document.getElementById("servicesGrid");
  grid.innerHTML = "";
  treatments.forEach(t => {
    const price = (t.price * rates[currency]).toFixed(2);
    grid.innerHTML += `
      <div class="service-card" onclick="openDetail(${t.id})">
        <h3>${t.name}</h3>
        <p>${t.desc}</p>
        <strong>${symbols[currency]} ${price}</strong><br><br>
        <button class="btn btn-primary" onclick="event.stopPropagation(); addToBudget(${t.id})">
          Agregar
        </button>
      </div>`;
  });
}

/* ===== DETALLE ===== */
function openDetail(id) {
  const t = treatments.find(x => x.id === id);
  document.getElementById("detailTitle").textContent = t.name;
  document.getElementById("detailDesc").textContent = t.desc;
  document.getElementById("detailModal").classList.add("active");
}

function closeDetailModal() {
  document.getElementById("detailModal").classList.remove("active");
}

/* ===== PRESUPUESTO ===== */
function addToBudget(id) {
  budget.push(treatments.find(t => t.id === id));
  updateBudget();
}

function updateBudget() {
  const ul = document.getElementById("budgetItems");
  let total = 0;
  ul.innerHTML = "";
  budget.forEach(b => {
    const price = b.price * rates[currency];
    total += price;
    ul.innerHTML += `<li>${b.name} - ${symbols[currency]} ${price.toFixed(2)}</li>`;
  });
  document.getElementById("budgetTotal").textContent =
    `${symbols[currency]} ${total.toFixed(2)}`;
}

/* ===== MONEDA ===== */
document.getElementById("currencySelector").onchange = e => {
  currency = e.target.value;
  localStorage.setItem("currency", currency);
  renderServices();
  updateBudget();
};
</script>

</body>
</html>

